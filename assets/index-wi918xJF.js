(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(t){if(t.ep)return;t.ep=!0;const a=n(t);fetch(t.href,a)}})();const $="AIzaSyDrY0hJrxNYavZXbov8PzRy6-QYEIZs_gs";let M,w=[],E=[],I=[],l={};function L(){const e={lat:-25.744104,lng:32.671572};M=new google.maps.Map(document.getElementById("map"),{center:e,zoom:18,mapTypeId:"satellite",disableDefaultUI:!0,gestureHandling:"greedy"}),B()}window.initMap=L;function C(e,o){const n=o*Math.PI/180;return{dx:e*Math.sin(n),dy:e*Math.cos(n)}}function f(e,o,n,r){const a=e+r/6371e3*(180/Math.PI),i=o+n/6371e3*(180/Math.PI)/Math.cos(e*Math.PI/180);return{lat:a,lng:i}}function R(){w.forEach(e=>e.setMap(null)),E.forEach(e=>e.setMap(null)),I.forEach(e=>e.setMap(null)),w=[],E=[],I=[]}function F(e,o,n){const r=`
            <svg xmlns="http://www.w3.org/2000/svg" width="${o}" height="${o}" viewBox="0 0 ${o} ${o}">
                <rect width="${o}" height="${o}" fill="${e}" stroke="#000000" stroke-width="1" transform="rotate(${n}, ${o/2}, ${o/2})"/>
            </svg>
        `.trim();return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(r)}function B(){R();const e=parseFloat(document.getElementById("lat").value),o=parseFloat(document.getElementById("lng").value),n=document.getElementById("loaiCot").value,r=parseFloat(document.getElementById("huongCuaTram").value),t=parseInt(document.getElementById("soMongCo").value),a=parseFloat(document.getElementById("doCaoCot").value),i=parseFloat(document.getElementById("kichThuocHangRaoRong").value),u=parseFloat(document.getElementById("kichThuocHangRaoDai").value);document.getElementById("infoPanel").innerHTML=`
		<p><strong>Loại cột:</strong> ${n==="day_co"?"Dây co":"Tự đứng"}</p>
		<p><strong>Hướng cửa trạm:</strong> ${r}°</p>
		<p><strong>Kích thước hàng rào:</strong> ${i} x ${u} m</p>
		<p><strong>Số móng co:</strong> ${t}</p>
		<p><strong>Độ cao cột:</strong> ${a} m</p>
		<p><strong>Longitude:</strong> ${o}</p>
		<p><strong>Latiude:</strong> ${e} </p>
	`;const p={lat:e,lng:o};M.setCenter(p);const g=a/3,d=[],h=[];if(n==="day_co"&&t===3)[180,300,60].forEach(m=>{const{dx:s,dy:c}=C(g,m);d.push(f(e,o,s,c)),h.push(m)});else if(n==="day_co"&&t===4){const s=g/Math.sqrt(3.9929),c=1.73*s;[{x:c,y:s,a:45},{x:-c,y:s,a:135},{x:-c,y:-s,a:225},{x:c,y:-s,a:315}].forEach(y=>{d.push(f(e,o,y.x,y.y)),h.push(y.a)})}else if(n==="tu_dung"){const m=360/t;for(let s=0;s<t;s++){const c=s*m,{dx:y,dy:k}=C(g,c);d.push(f(e,o,y,k)),h.push(c)}}l={center:p,mongs:d,originalAngles:h,banKinhRaMong:g},O()}function O(){R();const e=parseFloat(document.getElementById("huongCuaTram").value),o=new google.maps.Marker({position:l.center,map:M,icon:{url:F("red",16,e),scaledSize:new google.maps.Size(16,16),anchor:new google.maps.Point(8,8)},title:"Tâm cột",draggable:!1});w.push(o),l.mongs.forEach((n,r)=>{const t=new google.maps.Marker({position:n,map:M,icon:{url:F("#FF0000",12,0),scaledSize:new google.maps.Size(12,12),anchor:new google.maps.Point(6,6)},title:`Móng ${r+1}`,draggable:!0});w.push(t);const a=new google.maps.Polyline({path:[l.center,n],geodesic:!0,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2,map:M});E.push(a),google.maps.event.addListener(t,"drag",i=>T(i,r+1)),google.maps.event.addListener(t,"dragend",i=>{const u=w[0].getPosition(),p=i.latLng,g=p.lng()-u.lng(),d=p.lat()-u.lat(),m=(Math.atan2(g,d)*180/Math.PI+360)%360-l.originalAngles[r],s=[];l.originalAngles.forEach((c,y)=>{const k=(c+m+360)%360,{dx:x,dy:P}=C(l.banKinhRaMong,k);s.push(f(u.lat(),u.lng(),x,P))}),l.mongs=s,l.mongs.forEach((c,y)=>{w[y+1].setPosition(c),E[y].setPath([l.center,c])}),v()})}),v()}function T(e,o){const n=w[0].getPosition(),r=e.latLng,t=r.lng()-n.lng(),a=r.lat()-n.lat(),u=(Math.atan2(t,a)*180/Math.PI+360)%360-l.originalAngles[o-1],p=[];l.originalAngles.forEach((g,d)=>{const h=(g+u+360)%360,{dx:m,dy:s}=C(l.banKinhRaMong,h);p.push(f(n.lat(),n.lng(),m,s))}),l.mongs=p,l.mongs.forEach((g,d)=>{w[d+1].setPosition(g),E[d].setPath([l.center,g])}),v()}function v(){const e=l.center,o=parseFloat(document.getElementById("kichThuocHangRaoRong").value),n=parseFloat(document.getElementById("kichThuocHangRaoDai").value),r=parseFloat(document.getElementById("huongCuaTram").value),{dx:t,dy:a}=C(o,r-90),{dx:i,dy:u}=C(n,r),p=e,g=f(e.lat,e.lng,t,a),d=f(e.lat,e.lng,i,u),h=f(e.lat,e.lng,t+i,a+u),{dx:m,dy:s}=C(n-1,r);f(e.lat,e.lng,t+m,a+s);const{dx:c,dy:y}=C(n+5,r),k=f(e.lat,e.lng,c,y);if(I[0])I[0].setPath([p,g,h,d]);else{const P=new google.maps.Polygon({paths:[p,g,h,d],strokeColor:"#0000FF",strokeOpacity:.8,strokeWeight:2,fillColor:"#0000FF",fillOpacity:.25,map:M});I.push(P)}window.arrowMarker&&window.arrowMarker.setMap(null),window.arrowMarker=new google.maps.Marker({position:h,map:M,icon:{url:F("#FF9900",10,r),scaledSize:new google.maps.Size(10,10),anchor:new google.maps.Point(5,5)},title:"Cửa"}),w.push(window.arrowMarker);const x=new google.maps.Polyline({path:[l.center,k],geodesic:!0,strokeColor:"white",strokeOpacity:1,strokeWeight:3,map:M});E.push(x),window.arrowMarkerDir&&window.arrowMarkerDir.setMap(null),window.arrowMarkerDir=new google.maps.Marker({position:k,map:M,icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW,fillColor:"#FF9900",fillOpacity:1,strokeWeight:0,scale:6,rotation:r},title:"Hướng"}),w.push(window.arrowMarkerDir)}function A(){window.initMap=L;const e=document.createElement("script");e.src=`https://maps.googleapis.com/maps/api/js?key=${$}&callback=initMap&libraries=geometry`,e.async=!0,e.defer=!0,document.head.appendChild(e)}A();
